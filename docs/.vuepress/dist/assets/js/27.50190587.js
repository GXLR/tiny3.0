(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{231:function(t,e,a){"use strict";a.r(e);var v=a(0),_=Object(v.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"request"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request"}},[t._v("#")]),t._v(" Request")]),t._v(" "),a("h3",{attrs:{id:"描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#描述"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),a("p",[t._v("tiny提供了Request类封装http/https网络请求,实现了文件上传和下载功能。")]),t._v(" "),a("h3",{attrs:{id:"属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#属性"}},[t._v("#")]),t._v(" 属性")]),t._v(" "),a("table",{staticClass:"table table-bordered table-striped table-condensed"},[a("tr",[a("td",[t._v("属性")]),t._v(" "),a("td",[t._v("取值")]),t._v(" "),a("td",[t._v("描述")]),t._v(" "),a("td",[t._v("备注")])]),t._v(" "),a("tr",[a("td",[t._v("url")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("请求地址")]),t._v(" "),a("td",[t._v("支持本地(file:///)和网络(http://)")])]),t._v(" "),a("tr",[a("td",[t._v("method")]),t._v(" "),a("td",[t._v("get / post / delete / put")]),t._v(" "),a("td",[t._v("网络请求的方法")]),t._v(" "),a("td",[t._v("string")])]),t._v(" "),a("tr",[a("td",[t._v("success")]),t._v(" "),a("td",[t._v("function(data){}")]),t._v(" "),a("td",[t._v("网络请求成功的回调函数")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("error")]),t._v(" "),a("td",[t._v("function(info, errorCode){}")]),t._v(" "),a("td",[t._v("网络请求失败的回调函数")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("progress")]),t._v(" "),a("td",[t._v("function(percent){}")]),t._v(" "),a("td",[t._v("网络请求上传 / 下载进度的回调函数 ")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("name")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("接口规范")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("data")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("post请求体")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("file")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("form表单形式上传文件")]),t._v(" "),a("td",[t._v(" array ")])]),t._v(" "),a("tr",[a("td",[t._v("options")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("下载扩展")]),t._v(" "),a("td",[t._v(" dictionary ")])]),t._v(" "),a("tr",[a("td",[t._v("timeout")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("超时时间，单位毫秒")]),t._v(" "),a("td",[t._v(" string ")])]),t._v(" "),a("tr",[a("td",[t._v("unEncrypt")]),t._v(" "),a("td",[t._v("true / false ")]),t._v(" "),a("td",[t._v("是否加密")]),t._v(" "),a("td",[t._v(" string ")])])]),t._v(" "),a("h3",{attrs:{id:"方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方法"}},[t._v("#")]),t._v(" 方法")]),t._v(" "),a("table",{staticClass:"table table-bordered table-striped table-condensed"},[a("tr",[a("td",[t._v("事件")]),t._v(" "),a("td",[t._v("描述")]),t._v(" "),a("td",[t._v("备注")])]),t._v(" "),a("tr",[a("td",[t._v("send")]),t._v(" "),a("td",[t._v("发送网络请求")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("cancel")]),t._v(" "),a("td",[t._v("取消网络请求")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("addHeader")]),t._v(" "),a("td",[t._v("增加http请求头部信息")]),t._v(" "),a("td")])]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"send"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#send"}},[t._v("#")]),t._v(" send")]),t._v(" "),a("p",[t._v("发送网络请求")]),t._v(" "),a("p",[t._v("request.send()")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"cancel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cancel"}},[t._v("#")]),t._v(" cancel")]),t._v(" "),a("p",[t._v("取消网络请求")]),t._v(" "),a("p",[t._v("request.cancel()")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"addheader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#addheader"}},[t._v("#")]),t._v(" addHeader")]),t._v(" "),a("p",[t._v("增加http请求头部字段")]),t._v(" "),a("p",[t._v("request.addHeader(key, value)")]),t._v(" "),a("h5",{attrs:{id:"params"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#params"}},[t._v("#")]),t._v(" params")]),t._v(" "),a("ul",[a("li",[t._v("key:header头部key值")]),t._v(" "),a("li",[t._v("value:header头部value值")])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"网络请求示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络请求示例"}},[t._v("#")]),t._v(" 网络请求示例")]),t._v(" "),a("p",[t._v("1.特定格式的请求方式, 添加相应的请求头")]),t._v(" "),a("pre",[a("code",[t._v(' var request = new Request();\n request.url = serverIp;\n request.method = "post";\n request.addHeader("token","token2")\n request.data = "{\'info\':\'aaaa\'}";\n request.success = function(data){\n    alert(data);\n };\n request.error = function(e){\n    alert(e);\n };\n request.send();\n')])]),t._v(" "),a("p",[t._v("2.标准form表单传递数据")]),t._v(" "),a("pre",[a("code",[t._v(' var request = new Request();\n request.url = serverIp;\n request.method = "post";\n request.file = [{"fileURL":"url","fileName":"picfile","name":"a","mimeType","image/png"}];\n request.success = function(data){\n    alert(data);\n };\n request.error = function(e){\n    alert(e);\n };\n request.send();\n')])]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"数据映射（request新增功能）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据映射（request新增功能）"}},[t._v("#")]),t._v(" 数据映射（Request新增功能）")]),t._v(" "),a("h3",{attrs:{id:"功能说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#功能说明"}},[t._v("#")]),t._v(" 功能说明")]),t._v(" "),a("p",[t._v("在页面数据绑定中，为方便数据提交。根据数据接口规范返回值，从数据绑定中取值，自动形成body。")]),t._v(" "),a("h3",{attrs:{id:"使用说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用说明"}},[t._v("#")]),t._v(" 使用说明")]),t._v(" "),a("p",[t._v("每个tml文件都有自己对应的Model数据配置和Api请求配置。如"),a("strong",[t._v("login.tml")]),t._v(",对应数据文件为"),a("strong",[t._v("loginData.js")]),t._v("；使用的接口为"),a("strong",[t._v("login.json")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"新增属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新增属性"}},[t._v("#")]),t._v(" 新增属性")]),t._v(" "),a("p",[t._v("request新增参数")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("方法")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("描述")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("备注")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("name")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("接口名称")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),a("h3",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("#")]),t._v(" 示例")]),t._v(" "),a("p",[t._v("用例：用户登录，获取用户信息。"),a("br"),t._v("\n接口：（1）login.tml;(2)getUserInfo.tml"),a("br"),t._v("\nlogin请求参数：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("username")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("用户名")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("password")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("密码")])])])]),t._v(" "),a("p",[t._v("login返回参数：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("token")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("用户令牌")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("code")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("状态码")])])])]),t._v(" "),a("p",[t._v("getUserInfo请求参数：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("token")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("用户令牌")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("deviceId")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("设备ID")])])])]),t._v(" "),a("p",[t._v("getUserInfo返回参数：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("nikename")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("昵称")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("age")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("年龄")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("sex")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("性别")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("avatar")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("头像")])])])]),t._v(" "),a("p",[t._v("loginData.js如下：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('var DATA = {\n    userName : "user",\n    passWord : "",\n    UserInfo: {\n    \tnikename:"" \n    \ttoken: ""\n    \tage: "", \n    \tsex: "",\n    \tavatar:"" \n    },\n    deviceId:""\n};\nvar getUserInfo = {   //注释1\n\ttoken = DATA.UserInfo.token; //注释2\n}\n')])])]),a("p",[t._v("请求如下：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('  var request = new Request();\n  request.name = "login"; \n//或者使用以下代码\n//request.name = "getUserInfo";\n  request.success = new Function(data){\n      //do somethings in success\n  }\n  request.error = new Function(data){\n      //do something in error\n  }\n  request.send(); \n')])])]),a("ul",[a("li",[t._v("在使用request.interfaceName这个字段时，body的数据会从"),a("strong",[t._v("Data.js")]),t._v("中获取且只会匹配"),a("strong",[t._v("根字段")]),t._v("。")]),t._v(" "),a("li",[t._v("注释1: 某些特殊情况中，需要的字段并不在根内容中，需要声明。这时需要声明"),a("strong",[t._v("var name = {}")]),t._v(";")]),t._v(" "),a("li",[t._v("注释2: 在申明的接口中去申明key对应的value值具体是DATA数据中的哪个字段。")])])])}),[],!1,null,null,null);e.default=_.exports}}]);