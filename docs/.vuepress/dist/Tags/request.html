<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Request | Tiny3.0</title>
    <meta name="description" content="让移动开发更简单易用 高效 原生技术 极致体验">
    
    
    <link rel="preload" href="/assets/css/0.styles.2c5d1044.css" as="style"><link rel="preload" href="/assets/js/app.6cc757a3.js" as="script"><link rel="preload" href="/assets/js/2.a15a07d6.js" as="script"><link rel="preload" href="/assets/js/29.f2567c1c.js" as="script"><link rel="prefetch" href="/assets/js/10.fa887fc7.js"><link rel="prefetch" href="/assets/js/11.cd06ea9d.js"><link rel="prefetch" href="/assets/js/12.b9f8618d.js"><link rel="prefetch" href="/assets/js/13.489035a7.js"><link rel="prefetch" href="/assets/js/14.39f5943c.js"><link rel="prefetch" href="/assets/js/15.edfcd256.js"><link rel="prefetch" href="/assets/js/16.deeede77.js"><link rel="prefetch" href="/assets/js/17.d1768789.js"><link rel="prefetch" href="/assets/js/18.f71faf91.js"><link rel="prefetch" href="/assets/js/19.60678083.js"><link rel="prefetch" href="/assets/js/20.06741978.js"><link rel="prefetch" href="/assets/js/21.95b38e6d.js"><link rel="prefetch" href="/assets/js/22.2557020e.js"><link rel="prefetch" href="/assets/js/23.4496bd86.js"><link rel="prefetch" href="/assets/js/24.aecc1780.js"><link rel="prefetch" href="/assets/js/25.6a963f82.js"><link rel="prefetch" href="/assets/js/26.64d8db2d.js"><link rel="prefetch" href="/assets/js/27.7403dded.js"><link rel="prefetch" href="/assets/js/28.fd115b2a.js"><link rel="prefetch" href="/assets/js/3.3d78497d.js"><link rel="prefetch" href="/assets/js/30.519842fe.js"><link rel="prefetch" href="/assets/js/31.6a4d72f2.js"><link rel="prefetch" href="/assets/js/32.7f1f5116.js"><link rel="prefetch" href="/assets/js/33.b3fcf184.js"><link rel="prefetch" href="/assets/js/34.5ea645e1.js"><link rel="prefetch" href="/assets/js/35.d9d03b82.js"><link rel="prefetch" href="/assets/js/36.67df56fc.js"><link rel="prefetch" href="/assets/js/37.28cbaed4.js"><link rel="prefetch" href="/assets/js/38.8c2729b4.js"><link rel="prefetch" href="/assets/js/39.cf171efb.js"><link rel="prefetch" href="/assets/js/4.1c37bc38.js"><link rel="prefetch" href="/assets/js/40.353507bc.js"><link rel="prefetch" href="/assets/js/41.262dfa60.js"><link rel="prefetch" href="/assets/js/5.8d5058fd.js"><link rel="prefetch" href="/assets/js/6.88e45044.js"><link rel="prefetch" href="/assets/js/7.ce7dd7b1.js"><link rel="prefetch" href="/assets/js/8.57c03ce4.js"><link rel="prefetch" href="/assets/js/9.034d37d0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2c5d1044.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Tiny3.0</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">文档中心</a></div><div class="nav-item"><a href="http://www.mtiny.cn/tiny/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  杭州长亮
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">文档中心</a></div><div class="nav-item"><a href="http://www.mtiny.cn/tiny/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  杭州长亮
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tags</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>TinyJS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Tags/system.html" class="sidebar-link">System</a></li><li><a href="/Tags/window.html" class="sidebar-link">Window</a></li><li><a href="/Tags/navigator.html" class="sidebar-link">Navigator</a></li><li><a href="/Tags/encrypt.html" class="sidebar-link">Encrypt</a></li><li><a href="/Tags/document.html" class="sidebar-link">Document</a></li><li><a href="/Tags/element.html" class="sidebar-link">element</a></li><li><a href="/Tags/request.html" class="active sidebar-link">Request</a></li><li><a href="/Tags/Multipicker.html" class="sidebar-link">MultiPicker</a></li><li><a href="/Tags/actionsheet.html" class="sidebar-link">ActionSheet</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="request"><a href="#request" class="header-anchor">#</a> Request</h2> <h3 id="描述"><a href="#描述" class="header-anchor">#</a> 描述</h3> <p>tiny提供了Request类封装http/https网络请求,实现了文件上传和下载功能。</p> <h3 id="属性"><a href="#属性" class="header-anchor">#</a> 属性</h3> <table class="table table-bordered table-striped table-condensed"><tr><td>属性</td> <td>取值</td> <td>描述</td> <td>备注</td></tr> <tr><td>url</td> <td></td> <td>请求地址</td> <td>支持本地(file:///)和网络(http://)</td></tr> <tr><td>method</td> <td>get / post / delete / put</td> <td>网络请求的方法</td> <td>string</td></tr> <tr><td>success</td> <td>function(data){}</td> <td>网络请求成功的回调函数</td> <td></td></tr> <tr><td>error</td> <td>function(info, errorCode){}</td> <td>网络请求失败的回调函数</td> <td></td></tr> <tr><td>progress</td> <td>function(percent){}</td> <td>网络请求上传 / 下载进度的回调函数 </td> <td></td></tr> <tr><td>name</td> <td></td> <td>接口规范</td> <td></td></tr> <tr><td>data</td> <td></td> <td>post请求体</td> <td></td></tr> <tr><td>file</td> <td></td> <td>form表单形式上传文件</td> <td> array </td></tr> <tr><td>options</td> <td></td> <td>下载扩展</td> <td> dictionary </td></tr> <tr><td>timeout</td> <td></td> <td>超时时间，单位毫秒</td> <td> string </td></tr> <tr><td>unEncrypt</td> <td>true / false </td> <td>是否加密</td> <td> string </td></tr></table> <h3 id="方法"><a href="#方法" class="header-anchor">#</a> 方法</h3> <table class="table table-bordered table-striped table-condensed"><tr><td>事件</td> <td>描述</td> <td>备注</td></tr> <tr><td>send</td> <td>发送网络请求</td> <td></td></tr> <tr><td>cancel</td> <td>取消网络请求</td> <td></td></tr> <tr><td>addHeader</td> <td>增加http请求头部信息</td> <td></td></tr></table> <hr> <h4 id="send"><a href="#send" class="header-anchor">#</a> send</h4> <p>发送网络请求</p> <p>request.send()</p> <hr> <h4 id="cancel"><a href="#cancel" class="header-anchor">#</a> cancel</h4> <p>取消网络请求</p> <p>request.cancel()</p> <hr> <h4 id="addheader"><a href="#addheader" class="header-anchor">#</a> addHeader</h4> <p>增加http请求头部字段</p> <p>request.addHeader(key, value)</p> <h5 id="params"><a href="#params" class="header-anchor">#</a> params</h5> <ul><li>key:header头部key值</li> <li>value:header头部value值</li></ul> <hr> <h3 id="网络请求示例"><a href="#网络请求示例" class="header-anchor">#</a> 网络请求示例</h3> <p>1.特定格式的请求方式, 添加相应的请求头</p> <pre><code> var request = new Request();
 request.url = serverIp;
 request.method = &quot;post&quot;;
 request.addHeader(&quot;token&quot;,&quot;token2&quot;)
 request.data = &quot;{'info':'aaaa'}&quot;;
 request.success = function(data){
    alert(data);
 };
 request.error = function(e){
    alert(e);
 };
 request.send();
</code></pre> <p>2.标准form表单传递数据</p> <pre><code> var request = new Request();
 request.url = serverIp;
 request.method = &quot;post&quot;;
 request.file = [{&quot;fileURL&quot;:&quot;url&quot;,&quot;fileName&quot;:&quot;picfile&quot;,&quot;name&quot;:&quot;a&quot;,&quot;mimeType&quot;,&quot;image/png&quot;}];
 request.success = function(data){
    alert(data);
 };
 request.error = function(e){
    alert(e);
 };
 request.send();
</code></pre> <hr> <h2 id="数据映射（request新增功能）"><a href="#数据映射（request新增功能）" class="header-anchor">#</a> 数据映射（Request新增功能）</h2> <h3 id="功能说明"><a href="#功能说明" class="header-anchor">#</a> 功能说明</h3> <p>在页面数据绑定中，为方便数据提交。根据数据接口规范返回值，从数据绑定中取值，自动形成body。</p> <h3 id="使用说明"><a href="#使用说明" class="header-anchor">#</a> 使用说明</h3> <p>每个tml文件都有自己对应的Model数据配置和Api请求配置。如<strong>login.tml</strong>,对应数据文件为<strong>loginData.js</strong>；使用的接口为<strong>login.json</strong>。</p> <h3 id="新增属性"><a href="#新增属性" class="header-anchor">#</a> 新增属性</h3> <p>request新增参数</p> <table><thead><tr><th style="text-align:left;">方法</th> <th style="text-align:center;">描述</th> <th style="text-align:center;">备注</th></tr></thead> <tbody><tr><td style="text-align:left;">name</td> <td style="text-align:center;">接口名称</td> <td style="text-align:center;"></td></tr></tbody></table> <h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h3> <p>用例：用户登录，获取用户信息。<br>
接口：（1）login.tml;(2)getUserInfo.tml<br>
login请求参数：</p> <table><thead><tr><th style="text-align:left;">参数</th> <th style="text-align:center;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">username</td> <td style="text-align:center;">用户名</td></tr> <tr><td style="text-align:left;">password</td> <td style="text-align:center;">密码</td></tr></tbody></table> <p>login返回参数：</p> <table><thead><tr><th style="text-align:left;">参数</th> <th style="text-align:center;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">token</td> <td style="text-align:center;">用户令牌</td></tr> <tr><td style="text-align:left;">code</td> <td style="text-align:center;">状态码</td></tr></tbody></table> <p>getUserInfo请求参数：</p> <table><thead><tr><th style="text-align:left;">参数</th> <th style="text-align:center;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">token</td> <td style="text-align:center;">用户令牌</td></tr> <tr><td style="text-align:left;">deviceId</td> <td style="text-align:center;">设备ID</td></tr></tbody></table> <p>getUserInfo返回参数：</p> <table><thead><tr><th style="text-align:left;">参数</th> <th style="text-align:center;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">nikename</td> <td style="text-align:center;">昵称</td></tr> <tr><td style="text-align:left;">age</td> <td style="text-align:center;">年龄</td></tr> <tr><td style="text-align:left;">sex</td> <td style="text-align:center;">性别</td></tr> <tr><td style="text-align:left;">avatar</td> <td style="text-align:center;">头像</td></tr></tbody></table> <p>loginData.js如下：</p> <div class="language- extra-class"><pre class="language-text"><code>var DATA = {
    userName : &quot;user&quot;,
    passWord : &quot;&quot;,
    UserInfo: {
    	nikename:&quot;&quot; 
    	token: &quot;&quot;
    	age: &quot;&quot;, 
    	sex: &quot;&quot;,
    	avatar:&quot;&quot; 
    },
    deviceId:&quot;&quot;
};
var getUserInfo = {   //注释1
	token = DATA.UserInfo.token; //注释2
}
</code></pre></div><p>请求如下：</p> <div class="language- extra-class"><pre class="language-text"><code>  var request = new Request();
  request.name = &quot;login&quot;; 
//或者使用以下代码
//request.name = &quot;getUserInfo&quot;;
  request.success = new Function(data){
      //do somethings in success
  }
  request.error = new Function(data){
      //do something in error
  }
  request.send(); 
</code></pre></div><ul><li>在使用request.interfaceName这个字段时，body的数据会从<strong>Data.js</strong>中获取且只会匹配<strong>根字段</strong>。</li> <li>注释1: 某些特殊情况中，需要的字段并不在根内容中，需要声明。这时需要声明<strong>var name = {}</strong>;</li> <li>注释2: 在申明的接口中去申明key对应的value值具体是DATA数据中的哪个字段。</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Tags/element.html" class="prev">element</a></span> <span class="next"><a href="/Tags/Multipicker.html">MultiPicker</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6cc757a3.js" defer></script><script src="/assets/js/2.a15a07d6.js" defer></script><script src="/assets/js/29.f2567c1c.js" defer></script>
  </body>
</html>
